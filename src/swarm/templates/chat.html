{% extends "base.html" %}

{% block content %}
<div class="container">
    <h1>Chat</h1>
    {% if conversation %}
    <div id="chat-container">
        <div id="chat-messages" class="chat-messages">
            <!-- Messages will be appended here -->
        </div>
        <form id="chat-form" hx-post="{% url 'ws_django_chat' conversation.id %}" hx-swap="beforeend:#chat-messages" hx-target="#chat-messages">
            <input type="text" id="chat-input" name="message" placeholder="Type a message..." required>
            <button type="submit">Send</button>
        </form>
    </div>
    {% else %}
        <p>No conversation selected.</p>
    {% endif %}
</div>

<script>
document.getElementById('chat-form').addEventListener('submit', function(event) {
    event.preventDefault();
    const input = document.getElementById('chat-input');
    const message = input.value.trim();
    if (message) {
        const messageHtml = `<div class="user-message">${message}</div>`;
        document.getElementById('chat-messages').innerHTML += messageHtml;
        input.value = '';
        this.submit();
    }
});
</script>
{% endblock %}